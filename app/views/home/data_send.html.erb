<body>
  <div id="test"></div>
</body>
<style type="text/css">
  #test{
    color: white;
  }
</style>

<script type="text/javascript">
var test = document.getElementById("test");
window.onload = function(){
  var channel = "<%= @channel %>";
	var getDevice = (function(){
    var ua = navigator.userAgent;
    if(ua.indexOf('iPhone') > 0 || ua.indexOf('iPod') > 0 || ua.indexOf('Android') > 0 && ua.indexOf('Mobile') > 0){
    	var dispatcher = new WebSocketRails("evening-stream-72370.herokuapp.com/websocket");
      window.addEventListener("deviceorientation", function(e){
        // d_motion = e.rotationRate;
        // interval = e.interval;
        // aig = e.accelerationIncludingGravity;
        // acc = e.acceleration;
        // dispatcher.trigger("send_message", {chn: channel, d: d_motion, i: interval, aig: aig, acc: acc}, function(){console.logg('success')}, function(response){console.log(response)});
        test.innerHTML = e.alpha;
        alpha = e.alpha;
        beta = e.beta
        gamma = e.gamma;
        dispatcher.trigger("send_message", {a: alpha, b: beta, g: gamma}, function(){console.log('success')}, function(response){console.log(response)});
      });
      device = "mobile";
    }else{
      alert("This devise is not supported")
    }
  })();
}
</script>