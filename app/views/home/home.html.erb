
<script>
  var dispatcher = new WebSocketRails("evening-stream-72370.herokuapp.com/websocket");
  var form = document.getElementById("form");
  var rota_r;

  var getDevice = (function(){
    var ua = navigator.userAgent;
    if(ua.indexOf('iPhone') > 0 || ua.indexOf('iPod') > 0 || ua.indexOf('Android') > 0 && ua.indexOf('Mobile') > 0){
      document.body.addEventListener('devicemotion', function(e){
        rota_r = e.rotationRate;
      }, false);
    }else if(ua.indexOf('iPad') > 0 || ua.indexOf('Android') > 0){
      return 'tab';
    }else{
      return 'other';
    }
  })();

  getMousePosition();

  function getMousePosition(){
    dispatcher.trigger("send_message", {rota_r: rota_r});
    requestAnimationFrame(getMousePosition);
  }

  dispatcher.bind("send", function(data) {
    console.log(data.message);
  });
</script>